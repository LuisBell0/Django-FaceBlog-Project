{% extends 'blog/_base.html' %}
{% load static %}
{% block content %}

<div class="container">
  <div class="card w-100 shadow-xss rounded-xxl border-0 px-lg-4 p-2 mt-3 mb-1">
    <div class="card-body d-flex flex-column justify-content-center position-relative">
      <div class="d-flex flex-column flex-md-row align-items-md-start align-items-center">
        <span class="d-flex d-md-none font-lg fw-600 mb-2">{{user.username}}</span>
        <figure class="avatar mb-1 mb-md-3">
          {% if user.profile.profile_picture %}
            <img src="{{ user.profile.profile_picture.url }}"
              id="profile_picture"
              class="shadow-sm rounded-circle"
              alt="{{ user.username }} Profile Picture"
              width="90" height="90">
          {% else %}
            <img src="{% static 'blog/default.jpg' %}"
              id="profile_picture"
              class="shadow-sm rounded-circle"
              alt="{{ user.username }}"
              width="90" height="90">
          {% endif %}
        </figure>
        <div class="position-absolute top-0 end-0 d-md-none">
          <div class="d-flex flex-column align-items-center">
            <a class="text-dark" href="{% url 'profile-update' user.profile.pk %}" method="GET">
              <i class="bi bi-gear-fill font-lg text-dark"></i>
            </a>
            <span id="edit-profile-text" class="font-xssss">Edit Profile</span>
          </div>
        </div>
        <div class="d-flex flex-column w-100 ms-md-2">
          <div class="d-flex flex-column flex-md-row align-items-center justify-content-between m-2">
            <span class="d-none d-md-flex font-lg fw-600 mb-2">{{user.username}}</span>
            <span class="d-flex d-md-none mb-1 font-md">{{user.first_name}} {{user.last_name}}</span>
            <div class="d-flex flex-row justify-content-center mx-2">
              <div class="d-flex flex-row align-items-center me-2 p-1 bg-greylight rounded">
                <span class="fw-600 me-1">
                  {{posts.count}}
                </span>
                <span>
                  Posts
                </span>
              </div>
              <div class="d-flex flex-row align-items-center me-2 p-1 bg-greylight rounded">
                <a class="text-dark" href="{% url 'profile-followers' user.username %}">
                  <span class="fw-600">
                    {{followers.count}}
                  </span>
                  Followers
                </a>
              </div>
              <div class="d-flex flex-row align-items-center me-2 p-1 bg-greylight rounded">
                <a class="text-dark" href="{% url 'profile-following' user.username %}">
                  <span class="fw-600">
                    {{following.count}}
                  </span>
                  Following
                </a>
              </div>
            </div>
            <div class="d-none d-md-flex flex-md-column align-items-md-center">
              <a class="text-dark" href="{% url 'profile-update' user.profile.pk %}" method="GET">
                <i class="bi bi-gear-fill font-lg text-dark"></i>
              </a>
              <span id="edit-profile-text" class="font-xssss">Edit Profile</span>
            </div>
          </div>
          <div class="d-flex align-items-center m-2">
            <div class="d-flex flex-column">
              <span class="fw-600 d-none d-md-block">{{user.first_name}} {{user.last_name}}</span>
              {% if user.profile.bio%}
              <div class="see-more-container">
                <span class="d-block text-description">Bio: {{ user.profile.bio|linebreaksbr }}</span>
              </div>
              <span class="see-more-btn btn btn-link bg-trasnparent border-0 cursor-pointer text-primary p-0 text-decoration-none text-start mt-1 text-grey-500 d-none">Show More</span>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="card w-100 shadow-xss rounded-xxl border-0 px-lg-4 p-2 my-2">
    <div class="card-body d-flex flex-column justify-content-center position-relative">
      <div class="text-center mb-1">
        {% if posts %}
            <span class="font-lg">Posts</span>
        {% else %}
            <span class="font-md">You haven't post anything yet</span>
        {% endif %}
          <hr class="mt-0">
      </div>
      <div class="container p-0">
        <div class="row g-1 mb-1">
          {% for post in posts %}
            <div class="col-4">
              <div class="ratio ratio-1x1">
                {% if post.img %}
                  <img class="img-fluid w-100 h-100" src="{{ post.img.url }}" alt="{{ post.title }}" style="object-fit: cover;">
                {% else %}
                  <div class="d-flex justify-content-center align-items-center h-100">
                    <span>No Image Available</span>
                  </div>
                {% endif %}
              </div>
            </div>
        
            {% if forloop.counter|divisibleby:3 and not forloop.last %}
              </div><div class="row g-1 mb-1">
            {% endif %}
          {% endfor %}
        </div> 
      </div>   
    </div>
  </div>
</div>
{% endblock %}